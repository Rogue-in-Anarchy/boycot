await page.goto("https://www.boycotzionism.com/", { waitUntil: "networkidle0",
}); await page.setViewport({ width: 1050, height: 1050 }); await
navigationPromise; console.log("connected"); let previousItemCount = 0; let
currentItemCount = 0; let buttons = []; let contents = await page.$$(
".container > .infinite-scroll-component__outerdiv > .infinite-scroll-component
> .grid > .react-card-flip > .react-card-flipper > .react-card-front >
.border-slate-200 > .gap-1 > .bg-red-700" ); previousItemCount =
contents.length; while (previousItemCount !== currentItemCount) {
previousItemCount = currentItemCount; // Scroll to the bottom of the page await
page.evaluate(() => { window.scrollTo(0, document.body.scrollHeight); }); //
Wait for a brief moment for potential new items to load try { buttons.push(
await page.waitForFunction( `document.querySelectorAll('.container >
.infinite-scroll-component__outerdiv > .infinite-scroll-component > .grid >
.react-card-flip > .react-card-flipper > .react-card-front > .border-slate-200 >
.gap-1 > .bg-red-700').length > ${currentItemCount}` ) ); } catch {
console.log("Timeout waiting for new items. Exiting loop."); contents = await
page.$$( ".container > .infinite-scroll-component__outerdiv >
.infinite-scroll-component > .grid > .react-card-flip > .react-card-flipper >
.react-card-front > .border-slate-200 > .gap-1 > .bg-red-700" ); break; } //
Collect the newly loaded items const newItems = await page.$$( ".container >
.infinite-scroll-component__outerdiv > .infinite-scroll-component > .grid >
.react-card-flip > .react-card-flipper > .react-card-front > .border-slate-200 >
.gap-1 > .bg-red-700" ); // Update the count of total items collected so far
currentItemCount = newItems.length; // Optionally, process or store the new
items as needed // For example: for (const itemHandle of newItems) { const
itemText = await page.evaluate( (item) => item.textContent, itemHandle );
console.log(itemText); } console.log(currentItemCount, newItems.length,
previousItemCount); } console.log(contents, contents.length); const next = [];
for (const content of contents) { let start = 0; let end = 1050; // Scroll the
page to bring the element into view await page.evaluate((start, end) => {
window.scrollTo(start, end); }); await navigationPromise; await content.click();
await navigationPromise; page.screenshot({ path: "bocat.jpg" }); const _name =
await page.evaluate(() => { return document.querySelector(
"[data-focus-lock-disabled='false'] > .z-50 > .mx-auto > .border-solid > h3"
).innerText; }); console.log("name: ", _name); const _details = await
page.evaluate(() => { return document.querySelector(
"[data-focus-lock-disabled='false'] > .z-50 > .mx-auto > .flex-auto > .markdown"
).innerHTML; }); const _logo = await page.evaluate(() => { return document
.querySelector( "[data-focus-lock-disabled='false'] > .z-50 > .mx-auto >
.flex-auto > .justify-center > img" ) .getAttribute("src"); }); const _source =
await page.evaluate(() => { return document .querySelector(
"[data-focus-lock-disabled='false'] > .z-50 > .mx-auto > .justify-end > a" )
.getAttribute("href"); }); await page.click( "[data-focus-lock-disabled='false']
> .z-50 > .mx-auto > .justify-end > button" ); next.push({ name: _name, details:
_details, logo: _logo, source: _source, }); start = start + 1050; end = end +
1050; page.screenshot({ path: "bocot.jpg" }); } console.log(next) await
page.close();
